---
title: 第一章:计算机概述
date: 2020-8-13
tags: 
  - 考研
  - 计算机操作系统
author: pasre
location: Suzhou  
---

## 1 操作系统的概念、功能和目标

### 1.1 概念(定义)
  <font color="red">操作系统</font>(Operating System, OS)是指控制和管理整个计算机系统的硬件和软件资源，并合理地组织调度计算机的工作和资源的分配，以提供给用户和其他软件方便的接口和环境，它是计算机系统中最基本的<font color="red">系统软件</font>。  

  > 负责管理协调硬件、软件等计算机资源的工作  
  > 为上层用户、应用程序提供简单易用的服务  
  > 是一种系统软件

### 1.2 功能和目标
* 作为系统资源的管理者
  > 处理机管理  
  > 存储器管理  
  > 文件管理  
  > 设备管理  


* 作为用户和计算机硬件之间的接口
  1. 命令接口: 允许用户<font color="red">直接使用</font>  
      > 联机命令接口`(说一句做一句)`: <font color="red">交互式</font>命令接口  
      > 脱机命令接口`(说一堆做一堆)`: <font color="red">批处理</font>命令接口  
  2. 程序接口 / <font color="red">系统调用</font> / <font color="red">广义指令</font>: 允许用户通过程序<font color="red">直接使用</font>    
  3. GUI: 现在操作系统中最流行的图形化用户接口  


* 实现对硬件机器的拓展
  > 没有任何软件支持的计算机称为<font color="red">裸机</font>  
  > 通常把覆盖了软件的机器称为<font color="red">扩充机器</font>,有称之为<font color="red">虚拟机</font>


## 2 操作系统的特征

### 2.1 并发
  <font color="blue">并发</font>：指两个或多个事件在同一时间间隔内发生。这些事件<font color="red">宏观上是同时发生</font>的,但<font color="red">微观上是交替发生</font>的。  
  <font color="blue">并行</font>：指两个或多个事件同一时刻同时发生。  
  <font color="red">操作系统和程序并发是一起诞生的</font>
  
### 2.2 共享
  <font color="blue">共享</font>：即资源共享，是指系统中的资源可供内存中多个并发执行的进程共同使用。

  > 互斥共享：一个时间段内只允许一个进程访问该资源  
  > 同时共享：允许一个时间段内由多个进程"同时"对它们进行访问

  <font color="red">并发和共享互为存在条件</font>

### 2.3 虚拟
  <font color="red">虚拟</font>是指把一个物理上的实体变为若干个逻辑上的对应物。物理实体（前者）是实际存在的，而逻辑上对应物（后者）是用户感受到的。

  > 空分复用技术(如虚拟存储技术)  
  > 时分复用技术(如虚拟处理机)  

  <font color="red">没有并发性,就谈不上虚拟性</font>

### 2.4 异步
  <font color="red">异步</font>是指，在多道程序环境下，允许多个程序并发执行，但由于资源有限，进程的执行不是一贯到底的，而是走走停停，以不可预知的速度向前推进，这就是进程的异步性。

  <font color="red">只有系统拥有并发性，才有可能导致异步性</font>


## 3 操作系统的发展与分类

### 3.1 手工操作阶段
<font color="blue">主要缺点</font>：用户独占全机，人机速度矛盾导致资源利用率极低

### 3.2 批处理阶段
  * 单道批处理系统

    引入<font color="red">脱机输入/输出技术</font>(用磁带完成)，并<font color="red">监督程序</font>负责控制作业的输入、输出  

    <font color="blue">主要优点</font>：缓解了一定程度的人机速度矛盾，资源利用率有所提升  
    <font color="blue">主要缺点</font>：<font color="red">内存中仅能有一道程序运行</font>，只有该程序运行结束后才能调入下一道程序。<font color="red">CPU有大量空闲时间等到I/O完成</font>。资源利用率依然很低。
  
  * 多道批处理系统

    <font color="blue">主要优点</font>：多道程序<font color="red">并发</font>执行，<font color="red">共享</font>计算机资源。<font color="red">资源利用率大幅提升</font>，CPU和其他资源保持“忙碌”状态，系统吞吐量增大。  
    <font color="blue">主要缺点</font>：用户相应时间长，<font color="red">没有人机交互功能</font>（用户提交自己的作业之后就只能等待计算机处理完成，中间不能控制自己的作业执行）

### 3.3 分时操作系统
  计算机以<font color="red">时间片</font>为单位<font color="red">轮流为各个用户/作业服务</font>，各个用户可通过终端与计算机进行交互。  

  <font color="blue">主要优点</font>：用户请求可以被及时响应，<font color="red">解决了人机交互问题</font>。允许多个用户同时使用一台计算机，并且用户对计算机的操作相互独立，感受不到别人的存在。  
  <font color="blue">主要缺点</font>：<font color="red">不能优先处理一些紧急任务</font>。操作系统对各个用户/作业都是完全公平的，循环的为每个用户/作业服务一个时间片，不区分任务的紧急性。

### 3.4 实时操作系统
  <font color="blue">主要优点</font>：能用优先响应一些紧急任务，某些紧急任务不需时间片排定。  

  在实时操作系统的控制下，计算机系统接收到外部信号后及时进行处理，并且<font color="red">要在严格的时限内处理完事件</font>。实时操作系统的主要特点是<font color="red">及时性和可靠性</font>

  > 硬实时系统 `必须在绝对严格的规定时间内完成处理`  
  > 软实时系统 `能接受偶尔违反时间规定`  

### 3.5 其他操作系统
 * 网络操作系统
 * 分布式操作系统
 * 个人计算机操作系统

## 4 操作系统的运行机制与体系结构

### 4.1 运行机制
  * 两种指令
    > 特权指令：如内存清零  
    > 非特权指令： 如普通的运算指令

  * 两种处理器状态
    > 用户态(目态)  
    > 核心态(管态)

    用程序状态字寄存器(PSW)中的某个标志位来标识当前处理器处于什么状态

  * 两种程序
    > 内核程序 `运行在核心态`  
    > 应用程序 `只能执行非特权指令，运行在用户态`

### 4.2 操作系统内核
  <font color="red">内核</font>是计算机上配置的底层<font color="red">软件</font>，是操作系统最基本、最核心的部分。  
  实现操作系统内核功能的那些程序就是<font color="red">内核程序</font>

  * 时钟管理 `实现计时功能`
  * 中断处理 `负责实现中断机制`
  * 原语
    > 是一种特殊的程序  
    > 处于操作系统最底层，是最接近硬件的部分  
    > 这种程序的运行具有<font color="red">原子性</font>——其运行只能一气呵成，不可中断  
    > 运行时间较短、调用频繁  

  * 对系统资源进行管理的功能
    > 进程管理  
    > 存储器管理   
    > 设备管理  


### 4.2 操作系统的体系结构
  * 大内核
    > 将操作系统的主要功能模块都作为系统内核，运行在核心态  
    > <font color="blue">优点</font>：高性能  
    > <font color="blue">缺点</font>：内核代码庞大，结构混乱，难以维护

  * 微内核
    > 只把最基本的功能保留在内核  
    > <font color="blue">优点</font>：内核功能少，结构清晰，方便维护  
    > <font color="blue">缺点</font>：需要频繁的在核心态和用户态之间切换，性能低


## 5 中断和异常

### 5.1 中断机制的诞生
  引入中断机制，实现了多道程序并发执行  
  <font color="red">本质：发生中断</font>就意味着<font color="red">需要操作系统介入，开展管理工作</font>

### 5.2 中断的概念和作用
  > 当中断发生时，cpu立即进入<font color="red">核心态</font>  
  > 当中断发生时，当前运行的进程暂停运行，并由操作系统内核对中断进行处理  
  > 对于不同的中断信号，会进行不同的处理

  <font color="red">中断</font>可以使CPU从<font color="red">用户态切换为核心态，使操作系统获得计算机的控制权</font>  
  <font color="blue">用户态 => 核心态</font>  <font color="red">中断是唯一使用户态转换到核心态的方法</font>  
  <font color="blue">核心态 => 用户态</font>  是通过<font color="red">执行一个特权指令</font>，将程序状态字（PSW）的标识位设置为“用户态”

### 5.3 中断的分类
  * 内中断(也称`异常`、`例外`、`陷入`)
    > 自愿中断——指令中断  
    > 强迫中断
      > * 硬件故障
      > * 软件中断

  * 外中断(`中断`)
    > 外设请求  
    > 人工干预

### 5.4 外中断的处理过程
  > 每条指令执行结束后，CPU检查是否有外部中断信号  
  > 若有外部中断信号，则需要保护被中断进程的CPU环境  
  > 根据中断信号类型转入相应的中断处理程序  
  > 恢复原进程的CPU环境并退出中断，返回原进程继续往下执行

## 6 系统调用

### 6.1 什么是系统调用，有何作用
  程序接口由一组<font color="red">系统调用</font>组成  

  <font color="blue">系统调用</font>是操作系统提供给应用程序（程序员/编程人员）使用的接口，可以理解为一种可供应用程序调用的特殊函数，应用程序可以发出系统调用请求来获得操作系统的服务。

  应用程序通过<font color="red">系统调用</font>请求操作系统的服务。系统中的各种共享资源都由操作系统统一掌管，因此在用户程序中，凡是与资源有关的操作（如资源分配、I/O操作、文件管理等），都必须通过系统调用的方式向操作系统提出服务请求，由操作系统代为完成。这样<font color="red">可以保证系统的稳定性和安全性</font>，防止用户进行非法操作。

  <font color="red">系统调用会使处理器从用户态进入核心态</font>

  + 按功能分类
    > 设备管理 `完成设备的 请求/释放/启动 等功能`  
    > 文件管理 `完成文件的 读/写/创建/删除 等功能`  
    > 进程管理 `完成进程的 创建/撤销/阻塞/唤醒 等功能`  
    > 进程通信 `完成进程之间的 消息传递/信号传递 等功能`  
    > 内存管理 `完成内存的 分配/回收 等功能`


### 6.2 系统调用和库函数的区别
  |层级|描述|
  |--|--|
  |普通应用程序|可直接进行系统调用，也可使用库函数。有的库函数涉及系统调用，有的不涉及|
  |编程语言|向上提供库函数。有时会将系统调用封装成库函数，以隐藏系统调用的一些细节，使上层进行系统调用更加方便|
  |操作系统|向上提供系统调用|
  |裸机| |

### 6.3 系统调用背后的过程
  传递系统调用参数 → 执行陷入指令(<font color="red">用户态</font>) → 执行系统调用相应服务程序(<font color="red">核心态</font>) → 返回用户程序  

  注意：
  1. <font color="red">陷入指令</font>是在<font color="red">用户态</font>执行的，执行陷入指令之后立即引发一个<font color="red">内中断</font>，从而CPU<font color="red">进入核心态</font>  
  2. <font color="red">发出系统调用请求</font>是在<font color="red">用户态</font>，而<font color="red">对系统调用的相应处理</font>在<font color="red">核心态</font>下进行
  3. 陷入指令是<font color="red">唯一一个</font>只能在用户态执行，而不可在核心态执行的指令